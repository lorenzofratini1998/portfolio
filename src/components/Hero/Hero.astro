---
import { siteConfig } from "../../config";
import HeroBackground from "./HeroBackground.astro";
import SocialLink from "../../components/SocialLink.astro";
import { getSocialLinks } from "../../utils/socials";

const { accentColor } = siteConfig;
const socialLinks = getSocialLinks();
---

<div
  id="hero"
  class="relative isolate overflow-hidden bg-white py-24 md:h-screen"
  style={`--accent-color: ${accentColor}`}
>
  <HeroBackground accentColor={accentColor} />

  <div class="h-full mx-auto p-8 sm:p-12 md:p-24 flex items-center">
    <div class="flex flex-col-reverse md:flex-row items-center justify-start w-full gap-6 md:gap-10">
      
      <div class="text-left">
        <h2 class="text-pretty text-xl sm:text-2xl md:text-5xl font-bold tracking-tight text-gray-700 animate-fade-in">
          Hello ðŸ‘‹
        </h2>
        <h1 class="mt-6 sm:mt-8 md:mt-10 text-pretty text-4xl sm:text-5xl md:text-6xl lg:text-8xl font-bold tracking-tight text-gray-800 animate-fade-in animation-delay-200">
          I'm <span style={{ color: accentColor }}>{siteConfig.name}</span>
        </h1>
        <p class="mt-4 sm:mt-6 md:mt-8 text-pretty text-base sm:text-lg md:text-xl/8 font-medium text-gray-600 animate-fade-in animation-delay-400 max-w-2xl">
          {siteConfig.title}
        </p>

        {/* --- NUOVO BLOCCO CTA (Call To Action) --- */}
        <div class="mt-8 flex flex-wrap gap-4 items-center animate-fade-in animation-delay-600">
          
          {/* Bottone CV Espandibile (Rounded-LG) */}
          {siteConfig.resume && (
            <a
              href={siteConfig.resume}
              target="_blank"
              rel="noopener noreferrer"
              onclick="this.href = this.href.split('?')[0] + '?v=' + new Date().getTime();"
              class="group flex items-center gap-2 px-5 py-3 rounded-lg text-white font-medium transition-all duration-300 hover:-translate-y-1 hover:shadow-lg"
              style={{ backgroundColor: accentColor }}
            >
              <svg 
                xmlns="http://www.w3.org/2000/svg" 
                width="20" height="20" 
                viewBox="0 0 24 24" 
                fill="none" 
                stroke="currentColor" 
                stroke-width="2" 
                stroke-linecap="round" 
                stroke-linejoin="round"
              >
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="7 10 12 15 17 10"></polyline>
                <line x1="12" y1="15" x2="12" y2="3"></line>
              </svg>
              
              <div class="flex items-center">
                {/* Parte che si espande: "Download " */}
                <span class="max-w-0 overflow-hidden opacity-0 transition-all duration-300 ease-out group-hover:max-w-[80px] group-hover:opacity-100 whitespace-nowrap">
                  Download&nbsp;
                </span>
                
                {/* Parte fissa: "CV" */}
                <span>CV</span>
              </div>
            </a>
          )}

          {/* Social Icons */}
          <div class="flex gap-x-4 pl-4 border-l border-gray-200">
             {socialLinks.map((link) => (
              <SocialLink 
                name={link.name}
                url={link.url} 
                color={link.iconData.color}
                path={link.iconData.path}
              />
            ))}
          </div>

        </div>

      </div>

      {siteConfig.profileImage && (
        <div class="shrink-0 animate-fade-in animation-delay-200 relative group">
          <div 
            class="absolute -inset-1 rounded-full blur opacity-25 group-hover:opacity-75 transition duration-500"
            style={{ backgroundColor: accentColor }}
          ></div>
          <img 
            src={siteConfig.profileImage} 
            alt={siteConfig.name}
            class="relative size-40 sm:size-48 md:size-64 rounded-full object-cover object-[20%_50%] border-4 border-white shadow-2xl"
          />
        </div>
      )}
    </div>
  </div>

  {/* Ho rimosso il div 'absolute bottom-0' vecchio con i social link duplicati 
      perchÃ© ora sono integrati nel flusso principale sopra, che Ã¨ piÃ¹ UX friendly su mobile */}
</div>

<style>
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }
  .animate-fade-in { animation: fadeIn 0.8s ease-out forwards; opacity: 0; }
  .animation-delay-200 { animation-delay: 0.2s; }
  .animation-delay-400 { animation-delay: 0.4s; }
  .animation-delay-600 { animation-delay: 0.6s; }
</style>