---
import { siteConfig } from "../../config";
import type { ExperienceItem } from "../../config";

interface Props {
  exp: ExperienceItem;
  isLast: boolean;
}

const { exp, isLast } = Astro.props;
---

<div class="relative mb-12 last:mb-0">
  
  <div
    class="absolute left-1/2 -top-2 w-4 h-4 bg-white border-2 rounded-full -translate-x-1/2 z-20 transition-all duration-300"
    style={`border-color: ${siteConfig.accentColor}; background-color: ${siteConfig.accentColor}`}
  >
  </div>

  {!isLast && (
    <div class="absolute left-1/2 bottom-0 w-0.5 h-12 bg-gray-300 -translate-x-1/2 translate-y-full z-10" />
  )}

  <div class="bg-white rounded-lg shadow-sm border border-gray-100 p-4 sm:p-5 md:p-6 hover:shadow-md transition-shadow duration-300">

    <div class="flex gap-4 md:gap-6">
      
      {exp.logo && (
        <div class="shrink-0">
          {exp.url ? (
            <a 
              href={exp.url} 
              target="_blank" 
              rel="noopener noreferrer" 
              class="block hover:opacity-75 transition-opacity"
            >
              <img 
                src={exp.logo} 
                alt={`${exp.company} logo`} 
                class="w-12 h-12 md:w-16 md:h-16 rounded-full object-cover border border-gray-200" 
              />
            </a>
          ) : (
            <img 
              src={exp.logo} 
              alt={`${exp.company} logo`} 
              class="w-12 h-12 md:w-16 md:h-16 rounded-full object-cover border border-gray-200" 
            />
          )}
        </div>
      )}

      {/* 2. SEZIONE INFO */}
      <div class="flex-1">
        <div class="flex flex-col sm:flex-row sm:items-start sm:justify-between mb-4">
          <div>
            {/* Job Title */}
            <h3 class="text-lg sm:text-xl font-semibold text-gray-900 leading-tight">
              {exp.url ? (
                <a 
                  href={exp.url} 
                  target="_blank" 
                  rel="noopener noreferrer" 
                  class="hover:opacity-80 transition-opacity"
                >
                  {exp.company}
                </a>
              ) : (
                exp.company
              )}
            </h3>
            
            {/* Company Name (Linkabile e Colorato) */}
            <div class="text-base sm:text-lg font-medium mt-1" style={`color: ${siteConfig.accentColor}`}>
              {exp.title}
            </div>
          </div>
          
          {/* Date Range */}
          <span class="text-xs sm:text-sm text-gray-500 mt-2 sm:mt-0 whitespace-nowrap">
            {exp.dateRange}
          </span>
        </div>

        {/* Bullets */}
        <ul class="space-y-2">
          {exp.bullets.map((bullet) => (
            <li class="flex items-start">
              <span class="inline-block w-1.5 h-1.5 rounded-full bg-gray-400 mt-2 mr-3 flex-shrink-0" />
              <span 
                class="text-sm sm:text-base text-gray-600 leading-relaxed" 
                set:html={bullet} 
              />
            </li>
          ))}
        </ul>
      </div>

    </div>
  </div>
</div>